# 교차분석 (Cross-tabulation Analysis)

빅데이터분석기사 시험에서 중요한 범주형 데이터 분석 방법인 교차분석에 대해 정리합니다.

## 1. 교차분석의 개념

**교차분석(Cross-tabulation)**은 두 개 이상의 범주형 변수 간의 관계를 분석하는 통계적 방법입니다.

### 주요 특징
- **범주형 데이터** 분석에 사용
- **빈도(frequency)** 기반 분석
- **독립성 검정**이 핵심
- 교차표(contingency table) 사용

### 교차표(분할표) 구조

|  | 범주 B₁ | 범주 B₂ | ... | 범주 Bc | 합계 |
|---|---------|---------|-----|---------|------|
| **범주 A₁** | n₁₁ | n₁₂ | ... | n₁c | r₁ |
| **범주 A₂** | n₂₁ | n₂₂ | ... | n₂c | r₂ |
| **...** | ... | ... | ... | ... | ... |
| **범주 Ar** | nr₁ | nr₂ | ... | nrc | rr |
| **합계** | c₁ | c₂ | ... | cc | n |

- r × c 교차표 (r: 행의 수, c: 열의 수)
- nᵢⱼ: 관측빈도 (observed frequency)
- rᵢ: 행의 합계, cⱼ: 열의 합계
- n: 전체 표본 크기

## 2. 카이제곱 검정 (Chi-square Test)

### (1) 적합도 검정 (Goodness of Fit Test)

**목적**: 관측된 빈도가 **기대되는 분포**와 일치하는지 검정

**가설**:
- H₀: 관측값이 기대분포를 따른다
- H₁: 관측값이 기대분포를 따르지 않는다

**검정통계량**:

$$\chi^2 = \sum_{i=1}^{k} \frac{(O_i - E_i)^2}{E_i}$$

- Oᵢ: 관측빈도 (Observed frequency)
- Eᵢ: 기대빈도 (Expected frequency)
- k: 범주의 수
- 자유도: df = k - 1

**예제**: 주사위가 공정한지 검정

```python
import numpy as np
from scipy import stats

# 주사위를 60번 던진 결과
observed = np.array([8, 12, 10, 9, 11, 10])
# 공정한 주사위라면 각 눈이 10번씩 나와야 함
expected = np.array([10, 10, 10, 10, 10, 10])

# 적합도 검정
chi2_stat, p_value = stats.chisquare(observed, expected)

print(f"카이제곱 통계량: {chi2_stat:.4f}")
print(f"p-value: {p_value:.4f}")
print(f"자유도: {len(observed) - 1}")

if p_value > 0.05:
    print("결론: 주사위는 공정하다 (H₀ 채택)")
else:
    print("결론: 주사위는 공정하지 않다 (H₀ 기각)")
```

### (2) 독립성 검정 (Test of Independence)

**목적**: 두 범주형 변수가 **서로 독립적**인지 검정

**가설**:
- H₀: 두 변수는 독립이다 (연관성이 없다)
- H₁: 두 변수는 독립이 아니다 (연관성이 있다)

**기대빈도 계산**:

$$E_{ij} = \frac{(행 i의 합계) \times (열 j의 합계)}{전체 합계} = \frac{r_i \times c_j}{n}$$

**검정통계량**:

$$\chi^2 = \sum_{i=1}^{r}\sum_{j=1}^{c} \frac{(O_{ij} - E_{ij})^2}{E_{ij}}$$

- 자유도: df = (r - 1) × (c - 1)

**예제**: 성별과 제품 선호도의 독립성 검정

```python
import pandas as pd
from scipy.stats import chi2_contingency

# 교차표 생성
data = pd.DataFrame({
    '성별': ['남', '남', '남', '여', '여', '여', '남', '여', '남', '여'] * 10,
    '제품': ['A', 'B', 'A', 'B', 'A', 'B', 'A', 'A', 'B', 'B'] * 10
})

# 교차표
cross_tab = pd.crosstab(data['성별'], data['제품'])
print("교차표:")
print(cross_tab)
print()

# 독립성 검정
chi2, p_value, dof, expected = chi2_contingency(cross_tab)

print(f"카이제곱 통계량: {chi2:.4f}")
print(f"p-value: {p_value:.4f}")
print(f"자유도: {dof}")
print("\n기대빈도:")
print(pd.DataFrame(expected, 
                   index=cross_tab.index, 
                   columns=cross_tab.columns))

if p_value < 0.05:
    print("\n결론: 성별과 제품 선호도는 연관성이 있다 (H₀ 기각)")
else:
    print("\n결론: 성별과 제품 선호도는 독립이다 (H₀ 채택)")
```

### (3) 동질성 검정 (Test of Homogeneity)

**목적**: 여러 집단의 **분포가 동일한지** 검정

**가설**:
- H₀: 각 집단의 분포가 동일하다
- H₁: 각 집단의 분포가 다르다

**특징**:
- 독립성 검정과 수식은 동일
- 해석의 차이: 집단 간 비교에 초점

**예제**: 세 지역의 정당 지지율 비교

```python
# 세 지역의 정당 지지 현황
data = np.array([
    [45, 35, 20],  # 지역 A
    [40, 40, 20],  # 지역 B
    [30, 45, 25]   # 지역 C
])

chi2, p_value, dof, expected = chi2_contingency(data)

print("관측빈도:")
print(pd.DataFrame(data, 
                   index=['지역A', '지역B', '지역C'],
                   columns=['정당1', '정당2', '정당3']))
print(f"\n카이제곱 통계량: {chi2:.4f}")
print(f"p-value: {p_value:.4f}")

if p_value < 0.05:
    print("결론: 세 지역의 정당 지지 분포는 다르다")
else:
    print("결론: 세 지역의 정당 지지 분포는 동일하다")
```

## 3. 카이제곱 검정의 가정과 조건

### 필수 조건
1. **독립성**: 각 관측값은 독립적이어야 함
2. **기대빈도**: 모든 셀의 기대빈도 ≥ 5
   - 기대빈도 < 5인 셀이 20% 이상이면 검정 부적합
   - 2×2 표에서는 모든 셀의 기대빈도 ≥ 5

### 기대빈도가 작을 때 해결방법

#### 1) 범주 통합
```python
# 예: 연령대 범주를 통합
# [10대, 20대, 30대, 40대, 50대] → [20대 이하, 30-40대, 50대 이상]
```

#### 2) 피셔의 정확검정 (Fisher's Exact Test)
- 2×2 표에서 표본이 작을 때 사용
- 정확한 p-value 계산 (근사가 아님)

```python
from scipy.stats import fisher_exact

# 2×2 교차표
table = np.array([[8, 2],
                  [1, 5]])

oddsratio, p_value = fisher_exact(table)

print(f"오즈비: {oddsratio:.4f}")
print(f"p-value (양측검정): {p_value:.4f}")
```

#### 3) 예이츠 연속성 수정 (Yates' Correction)
- 2×2 표에서 표본이 작을 때 사용
- 카이제곱 통계량을 약간 감소시킴

```python
# correction=True로 예이츠 수정 적용
chi2, p_value, dof, expected = chi2_contingency(table, correction=True)
print(f"예이츠 수정 적용: χ² = {chi2:.4f}, p = {p_value:.4f}")

# correction=False로 일반 카이제곱
chi2, p_value, dof, expected = chi2_contingency(table, correction=False)
print(f"일반 카이제곱: χ² = {chi2:.4f}, p = {p_value:.4f}")
```

## 4. 연관성의 강도 측정

카이제곱 검정은 연관성의 **유무**만 판단하고, **강도**는 알려주지 않습니다.

### (1) Cramér's V (크래머의 V)

**범위**: 0 ≤ V ≤ 1

$$V = \sqrt{\frac{\chi^2}{n \times \min(r-1, c-1)}}$$

**해석**:
- V < 0.1: 매우 약한 연관성
- 0.1 ≤ V < 0.3: 약한 연관성
- 0.3 ≤ V < 0.5: 중간 연관성
- V ≥ 0.5: 강한 연관성

```python
def cramers_v(chi2, n, r, c):
    """크래머의 V 계산"""
    return np.sqrt(chi2 / (n * min(r-1, c-1)))

# 예제
chi2, p_value, dof, expected = chi2_contingency(cross_tab)
n = cross_tab.sum().sum()
r, c = cross_tab.shape

v = cramers_v(chi2, n, r, c)
print(f"Cramér's V: {v:.4f}")

if v < 0.1:
    print("연관성 강도: 매우 약함")
elif v < 0.3:
    print("연관성 강도: 약함")
elif v < 0.5:
    print("연관성 강도: 중간")
else:
    print("연관성 강도: 강함")
```

### (2) Phi 계수 (2×2 표 전용)

**범위**: -1 ≤ φ ≤ 1

$$\phi = \sqrt{\frac{\chi^2}{n}}$$

```python
def phi_coefficient(chi2, n):
    """Phi 계수 계산 (2×2 표)"""
    return np.sqrt(chi2 / n)

# 2×2 표에만 적용
if cross_tab.shape == (2, 2):
    phi = phi_coefficient(chi2, n)
    print(f"Phi 계수: {phi:.4f}")
```

### (3) 오즈비 (Odds Ratio) - 2×2 표 전용

$$OR = \frac{n_{11} \times n_{22}}{n_{12} \times n_{21}}$$

**해석**:
- OR = 1: 두 변수 독립
- OR > 1: 양의 연관성
- OR < 1: 음의 연관성

```python
def odds_ratio(table):
    """오즈비 계산 (2×2 표)"""
    return (table[0, 0] * table[1, 1]) / (table[0, 1] * table[1, 0])

# 예제
table_2x2 = np.array([[30, 10],
                      [20, 40]])

or_value = odds_ratio(table_2x2)
print(f"오즈비: {or_value:.4f}")

if or_value > 1:
    print("해석: 행 범주와 열 범주가 양의 연관성을 가짐")
elif or_value < 1:
    print("해석: 행 범주와 열 범주가 음의 연관성을 가짐")
else:
    print("해석: 행 범주와 열 범주가 독립적")
```

## 5. 맥니마 검정 (McNemar's Test)

**대응표본**의 범주형 데이터 분석 (쌍체 데이터)

**사용 예**:
- 치료 전후 비교
- 동일 대상의 반복 측정

**가설**:
- H₀: 변화 비율이 같다
- H₁: 변화 비율이 다르다

**검정통계량** (2×2 표):

|  | 사후 성공 | 사후 실패 |
|---|-----------|-----------|
| **사전 성공** | a | b |
| **사전 실패** | c | d |

$$\chi^2 = \frac{(b - c)^2}{b + c}$$

```python
from statsmodels.stats.contingency_tables import mcnemar

# 치료 전후 결과
# 행: 치료 전, 열: 치료 후
table = np.array([[20, 5],   # 치료 전 성공 → (성공 유지, 실패)
                  [10, 65]])  # 치료 전 실패 → (성공, 실패 유지)

result = mcnemar(table, exact=False)  # exact=True면 정확검정
print(f"맥니마 통계량: {result.statistic:.4f}")
print(f"p-value: {result.pvalue:.4f}")

if result.pvalue < 0.05:
    print("결론: 치료 전후 결과에 유의한 차이가 있다")
else:
    print("결론: 치료 전후 결과에 유의한 차이가 없다")
```

## 6. Python 실전 구현

### 완전한 교차분석 함수

```python
import numpy as np
import pandas as pd
from scipy.stats import chi2_contingency, fisher_exact
import matplotlib.pyplot as plt
import seaborn as sns

def cross_tabulation_analysis(data, var1, var2, alpha=0.05):
    """
    완전한 교차분석 수행
    
    Parameters:
    -----------
    data : DataFrame
    var1, var2 : 분석할 두 변수의 컬럼명
    alpha : 유의수준 (기본값 0.05)
    """
    print("=" * 70)
    print(f"교차분석: {var1} vs {var2}")
    print("=" * 70)
    
    # 1. 교차표 생성
    cross_tab = pd.crosstab(data[var1], data[var2], margins=True)
    print("\n[1] 교차표 (빈도)")
    print(cross_tab)
    
    # 2. 비율 교차표
    cross_tab_pct = pd.crosstab(data[var1], data[var2], 
                                 normalize='index') * 100
    print("\n[2] 행 기준 비율 (%)")
    print(cross_tab_pct.round(2))
    
    # 3. 카이제곱 검정
    observed = pd.crosstab(data[var1], data[var2])
    chi2, p_value, dof, expected = chi2_contingency(observed)
    
    print("\n[3] 카이제곱 검정 결과")
    print(f"   χ² 통계량: {chi2:.4f}")
    print(f"   p-value: {p_value:.4f}")
    print(f"   자유도: {dof}")
    
    # 4. 기대빈도 확인
    expected_df = pd.DataFrame(expected,
                               index=observed.index,
                               columns=observed.columns)
    print("\n[4] 기대빈도")
    print(expected_df.round(2))
    
    # 기대빈도 < 5인 셀 확인
    small_expected = (expected < 5).sum()
    total_cells = expected.size
    pct_small = (small_expected / total_cells) * 100
    
    print(f"\n   기대빈도 < 5인 셀: {small_expected}/{total_cells} ({pct_small:.1f}%)")
    
    if pct_small > 20:
        print("   ⚠️ 경고: 기대빈도 < 5인 셀이 20% 초과")
        if observed.shape == (2, 2):
            print("   → Fisher's Exact Test 권장")
    
    # 5. 결론
    print("\n[5] 검정 결론")
    if p_value < alpha:
        print(f"   p-value ({p_value:.4f}) < α ({alpha})")
        print(f"   → H₀ 기각: {var1}과(와) {var2}는 연관성이 있다")
    else:
        print(f"   p-value ({p_value:.4f}) ≥ α ({alpha})")
        print(f"   → H₀ 채택: {var1}과(와) {var2}는 독립이다")
    
    # 6. 연관성 강도 (Cramér's V)
    n = observed.sum().sum()
    r, c = observed.shape
    cramers_v = np.sqrt(chi2 / (n * min(r-1, c-1)))
    
    print("\n[6] 연관성 강도")
    print(f"   Cramér's V: {cramers_v:.4f}")
    
    if cramers_v < 0.1:
        strength = "매우 약함"
    elif cramers_v < 0.3:
        strength = "약함"
    elif cramers_v < 0.5:
        strength = "중간"
    else:
        strength = "강함"
    print(f"   강도 평가: {strength}")
    
    # 7. 시각화
    fig, axes = plt.subplots(1, 2, figsize=(14, 5))
    
    # 막대그래프
    cross_tab_pct.plot(kind='bar', ax=axes[0])
    axes[0].set_title(f'{var1} vs {var2} (비율)')
    axes[0].set_xlabel(var1)
    axes[0].set_ylabel('비율 (%)')
    axes[0].legend(title=var2)
    axes[0].grid(axis='y', alpha=0.3)
    
    # 히트맵
    sns.heatmap(observed, annot=True, fmt='d', cmap='Blues', ax=axes[1])
    axes[1].set_title(f'교차표 히트맵\nχ²={chi2:.2f}, p={p_value:.4f}')
    
    plt.tight_layout()
    plt.savefig('cross_tabulation.png', dpi=300, bbox_inches='tight')
    plt.show()
    
    print("\n" + "=" * 70)
    
    return {
        'chi2': chi2,
        'p_value': p_value,
        'dof': dof,
        'cramers_v': cramers_v,
        'cross_tab': cross_tab,
        'expected': expected_df
    }

# 사용 예제
data = pd.DataFrame({
    '성별': np.random.choice(['남', '여'], 200),
    '제품선호': np.random.choice(['A', 'B', 'C'], 200)
})

result = cross_tabulation_analysis(data, '성별', '제품선호')
```

## 7. 실전 예제 문제

### 문제 1: 기본 교차분석

다음 데이터는 흡연 여부와 폐암 발생 여부를 조사한 결과입니다. 두 변수의 독립성을 검정하시오. (α = 0.05)

|  | 폐암 발생 | 폐암 미발생 | 합계 |
|---|----------|------------|------|
| **흡연자** | 60 | 40 | 100 |
| **비흡연자** | 30 | 70 | 100 |
| **합계** | 90 | 110 | 200 |

```python
# 데이터 입력
observed = np.array([[60, 40],
                     [30, 70]])

# 카이제곱 검정
chi2, p_value, dof, expected = chi2_contingency(observed)

print("관측빈도:")
print(pd.DataFrame(observed, 
                   index=['흡연자', '비흡연자'],
                   columns=['폐암 발생', '폐암 미발생']))

print("\n기대빈도:")
print(pd.DataFrame(expected, 
                   index=['흡연자', '비흡연자'],
                   columns=['폐암 발생', '폐암 미발생']))

print(f"\nχ² = {chi2:.4f}")
print(f"p-value = {p_value:.4f}")
print(f"자유도 = {dof}")

# 수동 계산 검증
chi2_manual = 0
for i in range(2):
    for j in range(2):
        chi2_manual += (observed[i,j] - expected[i,j])**2 / expected[i,j]
print(f"\n수동 계산 χ² = {chi2_manual:.4f}")

# 결론
if p_value < 0.05:
    print("\n결론: 흡연과 폐암 발생은 연관성이 있다 (p < 0.05)")
else:
    print("\n결론: 흡연과 폐암 발생은 독립이다 (p ≥ 0.05)")

# 오즈비 계산
odds_ratio = (observed[0,0] * observed[1,1]) / (observed[0,1] * observed[1,0])
print(f"\n오즈비: {odds_ratio:.4f}")
print("해석: 흡연자가 비흡연자에 비해 폐암 발생 확률이 {:.2f}배".format(odds_ratio))
```

### 문제 2: 적합도 검정

한 회사의 제품 불량률이 A급 5%, B급 10%, C급 85%라고 주장합니다. 
실제 조사 결과 1000개 제품 중 A급 70개, B급 120개, C급 810개였습니다.
회사의 주장이 맞는지 검정하시오. (α = 0.05)

```python
# 관측 데이터
observed = np.array([70, 120, 810])

# 기대 데이터 (회사 주장)
n = 1000
expected = np.array([n * 0.05, n * 0.10, n * 0.85])

# 적합도 검정
chi2, p_value = stats.chisquare(observed, expected)

print("등급별 비교:")
comparison = pd.DataFrame({
    '등급': ['A급', 'B급', 'C급'],
    '관측빈도': observed,
    '기대빈도': expected,
    '차이': observed - expected
})
print(comparison)

print(f"\nχ² = {chi2:.4f}")
print(f"p-value = {p_value:.4f}")
print(f"자유도 = {len(observed) - 1}")

if p_value < 0.05:
    print("\n결론: 회사의 주장은 틀렸다 (관측 분포가 주장과 다름)")
else:
    print("\n결론: 회사의 주장이 맞다 (관측 분포가 주장과 일치)")
```

### 문제 3: 3×3 교차표

다음은 연령대와 운동 빈도를 조사한 결과입니다. 연관성을 분석하시오.

|  | 주 1회 이하 | 주 2-3회 | 주 4회 이상 |
|---|------------|---------|------------|
| **20대** | 30 | 40 | 30 |
| **30대** | 45 | 35 | 20 |
| **40대** | 55 | 25 | 20 |

```python
# 데이터
observed = np.array([[30, 40, 30],
                     [45, 35, 20],
                     [55, 25, 20]])

# 카이제곱 검정
chi2, p_value, dof, expected = chi2_contingency(observed)

print("관측빈도:")
print(pd.DataFrame(observed,
                   index=['20대', '30대', '40대'],
                   columns=['주 1회 이하', '주 2-3회', '주 4회 이상']))

print("\n기대빈도:")
print(pd.DataFrame(expected,
                   index=['20대', '30대', '40대'],
                   columns=['주 1회 이하', '주 2-3회', '주 4회 이상']).round(2))

print(f"\nχ² = {chi2:.4f}")
print(f"p-value = {p_value:.4f}")
print(f"자유도 = {dof}")

# Cramér's V
n = observed.sum()
r, c = observed.shape
cramers_v = np.sqrt(chi2 / (n * min(r-1, c-1)))
print(f"\nCramér's V = {cramers_v:.4f}")

if p_value < 0.05:
    print("\n결론: 연령대와 운동 빈도는 연관성이 있다")
    print(f"연관성 강도: ", end="")
    if cramers_v < 0.1:
        print("매우 약함")
    elif cramers_v < 0.3:
        print("약함")
    elif cramers_v < 0.5:
        print("중간")
    else:
        print("강함")
else:
    print("\n결론: 연령대와 운동 빈도는 독립이다")
```

## 8. 교차분석 vs 다른 검정 방법 비교

| 구분 | 교차분석 (카이제곱) | t-검정 | ANOVA |
|------|-------------------|--------|-------|
| **데이터 유형** | 범주형 vs 범주형 | 연속형 vs 범주형(2그룹) | 연속형 vs 범주형(3그룹+) |
| **검정 대상** | 독립성, 적합도 | 평균 차이 | 평균 차이 |
| **가정** | 기대빈도 ≥ 5 | 정규성, 등분산성 | 정규성, 등분산성 |
| **통계량** | χ² | t | F |

## 9. 시험 출제 포인트

### 자주 나오는 유형

1. **기대빈도 계산**
   - 행 합계 × 열 합계 / 전체 합계
   - 수동 계산 문제

2. **카이제곱 통계량 계산**
   - χ² = Σ(관측-기대)²/기대
   - 단계별 계산

3. **자유도 계산**
   - 적합도: k - 1
   - 독립성: (r-1)(c-1)

4. **검정 결론 도출**
   - p-value와 유의수준 비교
   - 귀무가설 채택/기각 판단

5. **적절한 검정 선택**
   - 카이제곱 vs Fisher's Exact
   - 독립성 vs 동질성 검정

### 핵심 개념 정리

| 개념 | 설명 |
|------|------|
| 기대빈도 조건 | 모든 셀 ≥ 5 |
| 자유도 (독립성) | (행-1) × (열-1) |
| 자유도 (적합도) | 범주 수 - 1 |
| Cramér's V 범위 | 0 ~ 1 |
| 오즈비 해석 | > 1: 양의 연관, < 1: 음의 연관 |

### 실수하기 쉬운 포인트

1. **기대빈도 계산 실수**
   - 행/열 합계를 잘못 사용
   - 전체 합계로 나누기 누락

2. **자유도 계산 오류**
   - (r-1)(c-1)을 r×c로 계산
   - marginal 포함하여 계산

3. **검정 선택 오류**
   - 기대빈도 < 5인데 카이제곱 사용
   - 대응표본인데 독립성 검정 사용

4. **p-value 해석 오류**
   - p-value가 작을수록 유의함 (주의!)
   - α와 비교 방향 착각

5. **연관성과 인과성 혼동**
   - 연관성 ≠ 인과관계

## 10. Python 주요 함수 정리

```python
# scipy.stats
from scipy.stats import chi2_contingency, chisquare, fisher_exact
from scipy.stats import chi2

# 독립성/동질성 검정
chi2, p, dof, expected = chi2_contingency(observed)

# 적합도 검정
chi2, p = chisquare(observed, expected)

# Fisher's Exact Test (2×2)
oddsratio, p = fisher_exact(table)

# 임계값
critical_value = chi2.ppf(1-alpha, df)

# pandas
import pandas as pd

# 교차표
pd.crosstab(df['var1'], df['var2'])

# 비율 교차표
pd.crosstab(df['var1'], df['var2'], normalize='index')  # 행 기준
pd.crosstab(df['var1'], df['var2'], normalize='columns')  # 열 기준
pd.crosstab(df['var1'], df['var2'], normalize='all')  # 전체 기준

# statsmodels
from statsmodels.stats.contingency_tables import mcnemar

# 맥니마 검정
result = mcnemar(table, exact=False)
```

## 11. 연습 문제

### 연습 1
다음 교차표에서 기대빈도를 계산하시오.

|  | B₁ | B₂ | 합계 |
|---|----|----|------|
| **A₁** | 20 | 30 | 50 |
| **A₂** | 40 | 60 | 100 |
| **합계** | 60 | 90 | 150 |

**풀이**:
```python
# E₁₁ = (50 × 60) / 150 = 20
# E₁₂ = (50 × 90) / 150 = 30
# E₂₁ = (100 × 60) / 150 = 40
# E₂₂ = (100 × 90) / 150 = 60

observed = np.array([[20, 30], [40, 60]])
chi2, p, dof, expected = chi2_contingency(observed)
print("기대빈도:")
print(expected)
# 결과: 관측빈도 = 기대빈도 → 완벽한 독립
```

### 연습 2
카이제곱 통계량이 9.488, 자유도가 4일 때, α=0.05에서 귀무가설을 기각할 수 있는가?

```python
from scipy.stats import chi2

chi2_stat = 9.488
dof = 4
alpha = 0.05

# 임계값
critical_value = chi2.ppf(1-alpha, dof)
print(f"임계값: {critical_value:.4f}")

# p-value
p_value = 1 - chi2.cdf(chi2_stat, dof)
print(f"p-value: {p_value:.4f}")

if chi2_stat > critical_value:
    print("결론: H₀ 기각")
else:
    print("결론: H₀ 채택")
```

## 12. 추가 참고사항

### 카이제곱 분포의 성질
- 자유도가 증가할수록 정규분포에 근사
- 항상 양수
- 오른쪽으로 치우친 분포

### 다차원 교차표
- 3개 이상의 변수: 로그-선형 모델 사용
- 층화 분석(Stratified analysis)

### 표준화 잔차 (Standardized Residuals)
- 각 셀의 기여도 파악
- |SR| > 2: 해당 셀이 카이제곱 통계량에 크게 기여

```python
# 표준화 잔차 계산
standardized_residuals = (observed - expected) / np.sqrt(expected)
print("표준화 잔차:")
print(pd.DataFrame(standardized_residuals,
                   index=['행1', '행2'],
                   columns=['열1', '열2']))
```

---

**작성일**: 2026-01-27  
**목적**: 빅데이터분석기사 시험 대비  
**주제**: 교차분석 (카이제곱 검정)
